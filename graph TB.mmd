graph TB
    Internet[("ğŸŒ<br/>Internet<br/>Users")]
    CF[("â˜ï¸<br/>Cloudflare<br/>CDN")]
    
    subgraph pi4 ["ğŸ´â€â˜ ï¸<br/>RPi 4<br/>Edge Server"]
        direction LR
        spacer_left["<br/><br/><br/><br/>"]
        Nginx{"âš“<br/>Nginx<br/>Reverse Proxy<br/>:80/:443"}
        Dashboard["ğŸ—ºï¸<br/>Powderchest<br/>Dashboard"]
        spacer_left ~~~ Nginx
    end
    
    subgraph pi5 ["â›µ<br/>RPi 5<br/>Compute Server"]
        Docker[["ğŸ‹<br/>Docker<br/>Engine"]]
        
        subgraph containers ["Containers"]
            MC1["ğŸ®<br/>TheStandard<br/>MC Server"]
            MC2["ğŸ®<br/>FakeMas0n<br/>MC Server"]
            PH["ğŸ›¡ï¸<br/>Pi-Hole<br/>DNS Sinkhole"]
            Unbound["ğŸ”’<br/>Unbound<br/>DNS Resolver"]
            WG["ğŸ”<br/>WireGuard<br/>VPN Tunnel"]
            Ollama["ğŸ¤–<br/>Ollama<br/>AI/LLM"]
        end
        
        BMRender["ğŸ—ºï¸<br/>BlueMap<br/>Renderer"]
    end
    
    subgraph storage ["ğŸ’° Network<br/>Storage"]
        spacer_storage["<br/><br/><br/><br/>"]
        SSD[("ğŸ’¾<br/>Samba Share<br/>2TB SSD<br/>World Data<br/>Map Tiles<br/>Images")]
    end
    
    subgraph legend ["ğŸ“‹ Key"]
        direction TB
        L1[("External Service")]
        L2{"Network/Proxy"}
        L3["Application"]
        L4[["Orchestrator"]]
        L5[("Storage/Database")]
        L6["â”€â”€â”€ Synchronous"]
        L7["â”€ â”€ Proxy/Async"]
        L8["â”â”â” Data Flow"]
    end
    
    %% Internet flow
    Internet -->|"HTTPS"|CF
    CF -->|"Protected"|Nginx
    
    %% Nginx routing
    Nginx -->|"Monitors"|Dashboard
    Nginx -.->|"Proxy"|MC1
    Nginx -.->|"Proxy"|MC2
    Nginx -.->|"Serves"|SSD
    Nginx -.->|"Serves"|SSD
    
    %% Docker orchestration
    Docker ==>|"Manages"|MC1
    Docker ==>|"Manages"|MC2
    Docker ==>|"Manages"|PH
    Docker ==>|"Manages"|Unbound
    Docker ==>|"Manages"|WG
    Docker ==>|"Manages"|Ollama
    
    %% Home network services
    PH <-->|"Filters"|Unbound
    Unbound <-->|"Routes"|WG
    
    %% Storage connections
    MC1 <-->|"Read/Write<br/>World Data"|SSD
    MC2 <-->|"Read/Write<br/>World Data"|SSD
    BMRender -->|"Writes<br/>Map Tiles"|SSD
    SSD -->|"Reads<br/>World Data"|BMRender
    
    %% Styling
    classDef cloudStyle fill:#1a1a2e,stroke:#00d4ff,stroke-width:4px,color:#00d4ff,font-weight:bold
    classDef proxyStyle fill:#1a1a2e,stroke:#2ecc71,stroke-width:4px,color:#2ecc71,font-weight:bold
    classDef appStyle fill:#1a1a2e,stroke:#e67e22,stroke-width:3px,color:#e67e22,font-weight:bold
    classDef containerStyle fill:#1a1a2e,stroke:#9b59b6,stroke-width:2px,color:#c39bd3
    classDef storageStyle fill:#1a1a2e,stroke:#d4af37,stroke-width:4px,color:#d4af37,font-weight:bold
    classDef orchestratorStyle fill:#1a1a2e,stroke:#3498db,stroke-width:3px,color:#3498db,font-weight:bold
    classDef legendStyle fill:#1a1a2e,stroke:#555,stroke-width:1px,color:#999,font-size:40px
    
    class Internet,CF cloudStyle
    class Nginx proxyStyle
    class Dashboard,BMRender appStyle
    class Docker orchestratorStyle
    class MC1,MC2,PH,Unbound,WG,Ollama containerStyle
    class SSD storageStyle
    class L1,L2,L3,L4,L5,L6,L7,L8 legendStyle